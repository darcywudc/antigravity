<div class="chapter-header fade-in">
    <span class="chapter-badge">第 8 章</span>
    <h1 class="chapter-title">穿越维度的传送门 <br><small style="font-size: 0.6em; color: var(--text-muted);">Nonsquare Matrices
            as Transformations</small></h1>
    <p class="chapter-description">
        到目前为止，我们只见过方形矩阵。但矩阵也可以是长方形的！
        它们就像维度之间的传送门——能把你从 2D 送到 3D，或者从 3D 压缩到 2D。
    </p>
</div>

<!-- 核心词汇 -->
<div class="section fade-in">
    <div class="vocab-summary">
        <div class="vocab-title">本章核心词汇</div>
        <div class="vocab-list">
            <div class="vocab-item"><span class="vocab-zh">非方阵</span><span class="vocab-en">Nonsquare Matrix</span>
            </div>
            <div class="vocab-item"><span class="vocab-zh">m×n 矩阵</span><span class="vocab-en">m×n Matrix</span></div>
            <div class="vocab-item"><span class="vocab-zh">嵌入</span><span class="vocab-en">Embedding</span></div>
            <div class="vocab-item"><span class="vocab-zh">投影</span><span class="vocab-en">Projection</span></div>
        </div>
    </div>
</div>

<!-- SECTION 1 -->
<div class="section fade-in">
    <h2 class="section-title">🚪 8.1 维度传送门</h2>

    <div class="content-block">
        <h3>🎮 类比：游戏地图的传送门</h3>
        <p>想象你在玩一个游戏：</p>
        <ul>
            <li>有一个传送门把你从 <strong>2D 地图</strong> 送到 <strong>3D 世界</strong></li>
            <li>另一个传送门把你从 <strong>3D 世界</strong> 压缩回 <strong>2D 小地图</strong></li>
        </ul>
        <p>
            <span class="term" data-en="Nonsquare Matrix">非方阵</span>就是这样的传送门！
        </p>

        <div class="theorem-card">
            <div class="theorem-title">💡 m×n 矩阵的含义</div>
            <p>一个 <strong>m×n</strong> 矩阵：</p>
            <ul style="margin: 0.5rem 0 0 0;">
                <li><strong>n 列</strong> → 输入空间是 n 维</li>
                <li><strong>m 行</strong> → 输出空间是 m 维</li>
            </ul>
            <p style="margin-top: 1rem; text-align: center; font-size: 1.1rem;">
                <strong>n 维</strong> $\xrightarrow{\text{m×n 矩阵}}$ <strong>m 维</strong>
            </p>
        </div>
    </div>
</div>

<!-- SECTION 2 -->
<div class="section fade-in">
    <h2 class="section-title">📤 8.2 从低维到高维（嵌入）</h2>

    <div class="content-block">
        <div class="example-ladder">
            <div class="example-step">
                <div class="step-number">→</div>
                <div class="step-content">
                    <div class="step-label">3×2 矩阵：2D → 3D</div>
                    <div class="math-block">
                        $\begin{bmatrix} 1 & 0 \\ 0 & 1 \\ 1 & 1 \end{bmatrix} \begin{bmatrix} x \\ y \end{bmatrix} =
                        \begin{bmatrix} x \\ y \\ x+y \end{bmatrix}$
                    </div>
                    <p style="margin-top: 0.5rem;">
                        2D 平面上的点被<span class="term" data-en="Embedding">嵌入</span>到 3D 空间中，
                        落在一个倾斜的平面上。
                    </p>
                </div>
            </div>
        </div>

        <div class="aha-box">
            <div class="aha-title">几何直觉</div>
            <p>
                想象把一张纸（2D）放进房间（3D）里。纸上的每个点现在都有了一个 3D 坐标，
                但这些点仍然只能在纸面上移动——它们被"嵌入"到了 3D 空间的一个子集中。
            </p>
        </div>
    </div>
</div>

<!-- SECTION 3 -->
<div class="section fade-in">
    <h2 class="section-title">📥 8.3 从高维到低维（投影）</h2>

    <div class="content-block">
        <div class="example-ladder">
            <div class="example-step">
                <div class="step-number">→</div>
                <div class="step-content">
                    <div class="step-label">2×3 矩阵：3D → 2D</div>
                    <div class="math-block">
                        $\begin{bmatrix} 1 & 0 & 0 \\ 0 & 1 & 0 \end{bmatrix} \begin{bmatrix} x \\ y \\ z \end{bmatrix}
                        = \begin{bmatrix} x \\ y \end{bmatrix}$
                    </div>
                    <p style="margin-top: 0.5rem;">
                        这是一个<span class="term" data-en="Projection">投影</span>！
                        3D 点被"压扁"到 XY 平面，Z 坐标信息<strong>丢失</strong>了。
                    </p>
                </div>
            </div>
        </div>

        <div class="connection-box">
            <div class="connection-title">与现实世界的联系</div>
            <p>
                📷 <strong>相机就是这样工作的</strong>：把 3D 世界投影到 2D 照片上。
                你无法从照片完全还原 3D 场景（深度信息丢失了）。
            </p>
        </div>

        <div class="theorem-card" style="border-left-color: var(--accent-orange);">
            <div class="theorem-title">⚠️ 重要区别</div>
            <ul style="margin: 0;">
                <li><strong>m > n（升维）</strong>：没有信息丢失，可以"逆向"（伪逆）</li>
                <li><strong>m < n（降维）</strong>：信息丢失，无法完全恢复</li>
            </ul>
        </div>
    </div>
</div>

<!-- 应用 -->
<div class="section fade-in">
    <h2 class="section-title">🌍 8.4 非方阵的应用</h2>

    <div class="real-world">
        <div class="real-world-item">
            <div class="rw-icon">📊</div>
            <div class="rw-title">数据降维</div>
            <div class="rw-desc">PCA 把高维数据投影到低维</div>
        </div>
        <div class="real-world-item">
            <div class="rw-icon">🤖</div>
            <div class="rw-title">词嵌入</div>
            <div class="rw-desc">把单词映射到向量空间</div>
        </div>
        <div class="real-world-item">
            <div class="rw-icon">🎮</div>
            <div class="rw-title">3D 渲染</div>
        </div>
        <div class="real-world-item">
            <div class="rw-icon">📱</div>
            <div class="rw-title">图像压缩</div>
            <div class="rw-desc">减少存储维度</div>
        </div>
    </div>

    <!-- 新增：练习题 -->
    <div class="challenge-box" style="margin-top: 2rem;">
        <div class="challenge-title">✍️ 动手练习</div>
        <p><strong>判断下列矩阵代表"升维"（嵌入）还是"降维"（投影）：</strong></p>
        <ol>
            <li>一个 $3 \times 2$ 矩阵</li>
            <li>一个 $1 \times 3$ 矩阵</li>
            <li>一个 $100 \times 10$ 矩阵</li>
        </ol>
        <details style="margin-top: 1rem;">
            <summary style="cursor: pointer; color: var(--accent-blue); font-weight: bold;">👆 点击查看答案</summary>
            <div style="margin-top: 0.5rem; padding: 1rem; background: rgba(16, 185, 129, 0.1); border-radius: 8px;">
                <ol>
                    <li><strong>升维 (2D → 3D)</strong>：2 列输入，3 行输出。信息保留（嵌入）。</li>
                    <li><strong>降维 (3D → 1D)</strong>：3 列输入，1 行输出。信息丢失（投影）。</li>
                    <li><strong>升维 (10D → 100D)</strong>：10 列输入，100 行输出。通常用于特征提取。</li>
                </ol>
            </div>
        </details>
    </div>

    <!-- 新增：思考题 -->
    <div class="challenge-box" style="margin-top: 2rem;">
        <div class="challenge-title">🤔 想一想</div>
        <p><strong>如果把一个 3D 物体投影到 2D 照片上（降维），还能把它完全还原回 3D 吗？</strong></p>
        <details style="margin-top: 1rem;">
            <summary style="cursor: pointer; color: var(--accent-blue); font-weight: bold;">👆 点击查看答案</summary>
            <div style="margin-top: 0.5rem; padding: 1rem; background: rgba(16, 185, 129, 0.1); border-radius: 8px;">
                <p><strong>答案</strong>：不能（通常情况下）。</p>
                <p>投影过程丢失了"深度"信息。同一个 2D 点可能对应原来 3D 空间中一条线上的无数个点。</p>
                <p style="margin-top: 0.5rem; font-size: 0.9em; color: var(--text-muted);">
                    💡 这就是为什么只有一张照片很难建模出精确的 3D 模型，通常需要从不同角度拍多张照片！
                </p>
            </div>
        </details>
    </div>

    <!-- 新增：趣味知识 -->
    <div class="deep-dive" style="margin-top: 2rem; border-left: 4px solid var(--accent-purple);">
        <div class="deep-title">🧠 趣味应用：ChatGPT 的"词向量"</div>
        <p>
            在大型语言模型中，每个单词都被表示为一个巨大的向量（比如 12288 维！）。
            为了在屏幕上显示单词之间的关系，我们会用"降维矩阵"把它们投影到 2D 或 3D 空间。
        </p>
        <p style="margin-top: 0.5rem;">
            这就是为什么我们能画出"国王-男人+女人=女王"这样的向量关系图。
        </p>
    </div>
</div>

<!-- ==================== 实战应用 ==================== -->
<div class="section fade-in">
    <h2 class="section-title">🎯 实战应用：用非方阵解决真实问题</h2>

    <div class="content-block">
        <p style="font-size: 1.1rem; margin-bottom: 2rem;">
            非方阵是连接不同"世界"的桥梁——从低维嵌入到高维，或从高维投影到低维。这是机器学习和3D图形的基础。
        </p>

        <!-- 问题 1：词嵌入查询 -->
        <div class="deep-dive" style="border-left: 4px solid var(--accent-blue); margin-bottom: 2rem;">
            <div class="deep-title">🔤 问题 1：词向量嵌入</div>

            <div style="background: rgba(74, 158, 255, 0.05); padding: 1rem; border-radius: 8px; margin: 1rem 0;">
                <p><strong>场景</strong>：一个简单的词嵌入系统用 One-Hot 编码表示单词（3个词的词汇表）。嵌入矩阵 $E$ 把 3D 空间映射到 2D：</p>
                <div class="math-block">
                    $E = \begin{bmatrix}1 & 0 & 0.5\\0 & 1 & 0.5\end{bmatrix}$
                </div>
                <p>"猫" = $(1, 0, 0)$，"狗" = $(0, 1, 0)$，"宠物" = $(0, 0, 1)$</p>
                <p><strong>问题</strong>：这三个词在 2D 嵌入空间中的位置是什么？</p>
            </div>

            <div class="example-ladder">
                <div class="example-step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <div class="step-label">计算嵌入：$E \times \text{词向量}$</div>
                        <p>猫：$E \cdot (1,0,0)^T = (1, 0)$</p>
                        <p>狗：$E \cdot (0,1,0)^T = (0, 1)$</p>
                        <p>宠物：$E \cdot (0,0,1)^T = (0.5, 0.5)$</p>
                    </div>
                </div>
                <div class="example-step">
                    <div class="step-number">✓</div>
                    <div class="step-content" style="background: rgba(16, 185, 129, 0.1);">
                        <div class="step-label" style="color: var(--accent-green);">答案</div>
                        <p>"宠物"在 2D 空间中位于"猫"和"狗"的<strong>中间</strong>！这正是我们期望的语义关系。</p>
                    </div>
                </div>
            </div>

            <div class="aha-box" style="margin-top: 1rem;">
                <div class="aha-title">💡 这就是 Word2Vec 的基础</div>
                <p>ChatGPT 和所有语言模型都用类似的嵌入矩阵把离散的单词转换成连续的向量空间，从而捕获语义关系！</p>
            </div>
        </div>

        <!-- 问题 2：3D 投影到屏幕 -->
        <div class="deep-dive" style="border-left: 4px solid var(--accent-orange); margin-bottom: 2rem;">
            <div class="deep-title">📺 问题 2：3D 点投影到屏幕</div>

            <div style="background: rgba(249, 115, 22, 0.05); padding: 1rem; border-radius: 8px; margin: 1rem 0;">
                <p><strong>场景</strong>：简化的正交投影（忽略透视）。一个 3D 游戏中的点 $(3, 2, 5)$ 需要投影到 2D 屏幕上（丢弃 Z 坐标）。</p>
                <p>投影矩阵：$P = \begin{bmatrix}1 & 0 & 0\\0 & 1 & 0\end{bmatrix}$</p>
            </div>

            <div class="example-ladder">
                <div class="example-step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <div class="step-label">应用投影矩阵</div>
                        <div class="math-block">
                            $P \cdot \begin{bmatrix}3\\2\\5\end{bmatrix} = \begin{bmatrix}1 \cdot 3 + 0 \cdot 2 + 0
                            \cdot 5\\0 \cdot 3 + 1 \cdot 2 + 0 \cdot 5\end{bmatrix} = \begin{bmatrix}3\\2\end{bmatrix}$
                        </div>
                    </div>
                </div>
                <div class="example-step">
                    <div class="step-number">✓</div>
                    <div class="step-content" style="background: rgba(16, 185, 129, 0.1);">
                        <div class="step-label" style="color: var(--accent-green);">答案</div>
                        <p>屏幕上的位置是 <strong>$(3, 2)$</strong>。Z 坐标（深度）被丢弃了！</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- 问题 3：降维用于可视化 -->
        <div class="deep-dive" style="border-left: 4px solid var(--accent-purple);">
            <div class="deep-title">📊 问题 3：高维数据可视化</div>

            <div style="background: rgba(139, 92, 246, 0.05); padding: 1rem; border-radius: 8px; margin: 1rem 0;">
                <p><strong>场景</strong>：你有一组 4D 数据点，想在 2D 图上显示。使用降维矩阵：</p>
                <div class="math-block">
                    $D = \begin{bmatrix}1 & 0 & 0.5 & 0\\0 & 1 & 0 & 0.5\end{bmatrix}$
                </div>
                <p>数据点：$(2, 3, 1, 2)$</p>
            </div>

            <div class="example-ladder">
                <div class="example-step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <div class="step-label">投影到 2D</div>
                        <div class="math-block">
                            $D \cdot \begin{bmatrix}2\\3\\1\\2\end{bmatrix} = \begin{bmatrix}2 + 0.5\\3 + 1\end{bmatrix}
                            = \begin{bmatrix}2.5\\4\end{bmatrix}$
                        </div>
                    </div>
                </div>
                <div class="example-step">
                    <div class="step-number">✓</div>
                    <div class="step-content" style="background: rgba(16, 185, 129, 0.1);">
                        <div class="step-label" style="color: var(--accent-green);">答案</div>
                        <p>在 2D 可视化图上，这个点显示在 <strong>$(2.5, 4)$</strong>。</p>
                    </div>
                </div>
            </div>

            <div class="aha-box" style="margin-top: 1rem;">
                <div class="aha-title">💡 这就是 PCA 的工作原理</div>
                <p>主成分分析 (PCA) 找到最重要的方向，然后用一个瘦矩阵把高维数据投影到低维，用于可视化或去噪！</p>
            </div>
        </div>

        <!-- 挑战题 -->
        <div class="challenge-box" style="margin-top: 2rem;">
            <div class="challenge-title">🚀 挑战：升维操作</div>
            <p><strong>问题</strong>：矩阵 $\begin{bmatrix}1 & 0\\0 & 1\\1 & 1\end{bmatrix}$ 把 2D 点 $(2, 3)$ 映射到哪里？</p>
            <details style="margin-top: 1rem;">
                <summary style="cursor: pointer; color: var(--accent-blue); font-weight: bold;">👆 点击查看答案</summary>
                <div
                    style="margin-top: 0.5rem; padding: 1rem; background: rgba(16, 185, 129, 0.1); border-radius: 8px;">
                    <p>$\begin{bmatrix}1 & 0\\0 & 1\\1 & 1\end{bmatrix} \begin{bmatrix}2\\3\end{bmatrix} =
                        \begin{bmatrix}2\\3\\5\end{bmatrix}$</p>
                    <p>2D 点被嵌入到 3D 空间，位置是 $(2, 3, 5)$。第三个坐标 = x + y。</p>
                </div>
            </details>
        </div>

    </div>
</div>

<!-- 总结 -->
<div class="section fade-in">
    <h2 class="section-title">🎯 本章收获</h2>

    <div class="content-block">
        <div class="theorem-card">
            <div class="theorem-title">核心要点</div>
            <ol style="margin: 0; padding-left: 1.5rem; line-height: 2.2;">
                <li>矩阵不一定是方形的</li>
                <li><strong>m×n 矩阵</strong>：从 n 维到 m 维的"传送门"</li>
                <li><strong>m > n</strong>（升维）：嵌入，信息保留</li>
                <li><strong>m < n</strong>（降维）：投影，信息丢失</li>
            </ol>
        </div>
    </div>
</div>