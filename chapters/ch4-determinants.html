<div class="chapter-header fade-in">
    <span class="chapter-badge">第 4 章 | Chapter 4</span>
    <h1 class="chapter-title">行列式 <br><small style="font-size: 0.6em; color: var(--text-muted);">Determinants</small>
    </h1>
    <p class="chapter-description">
        行列式是一个神奇的数字。它将整个矩阵压缩为单一标量，却能告诉我们关于矩阵变换性质的几乎所有秘密：是否可逆？是否缩放了体积？是否改变了方向？
    </p>
</div>

<div class="section fade-in">
    <h2 class="section-title">4.1 几何意义：面积缩放因子 <small
            style="font-weight: normal; color: var(--text-muted); font-size: 0.8em;">Scaling Factor</small></h2>

    <div class="content-block">
        <p>
            对于一个 $2 \times 2$ 矩阵 $A$，其行列式 $\det(A)$ 有一个非常直观的几何解释：
            <strong>它代表了线性变换改变面积的倍率。</strong>
        </p>
        <p>
            想象一个单位正方形（面积为1）。应用线性变换 $A$ 后，它变成了一个平行四边形。
            这个平行四边形的面积正是 $|\det(A)|$。
        </p>
        <ul>
            <li>如果 $\det(A) = 2$，原图形的面积变为原来的2倍。</li>
            <li>如果 $\det(A) = 0.5$，原图形被压缩，面积减半。</li>
            <li>如果 $\det(A) = 0$，图形被压扁成一条线或一个点，面积变为0。这不仅意味着面积消失，也意味着变换是不可逆的（信息丢失）。</li>
        </ul>

        <h3>正负号的含义 (Signed Volume)</h3>
        <p>
            行列式可以是负数。负号代表了<strong>方向的翻转 (Orientation Reversal)</strong>。
            这就好比你看着镜子里的自己，虽然大小没变（绝对值不变），但左手变成了右手。
            在二维平面上，正定行列式保持基向量 $\mathbf{i}$ 到 $\mathbf{j}$ 的逆时针顺序；负定行列式则将其翻转为顺时针。
        </p>
    </div>

    <div class="viz-container">
        <div class="viz-header">
            <span class="viz-title">交互演示：行列式的几何意义</span>
            <span class="viz-badge">Interactive</span>
        </div>
        <div class="viz-canvas-wrapper" style="height: 400px;">
            <canvas id="viz-determinant" style="width: 100%; height: 100%;"></canvas>
        </div>
        <div class="viz-controls">
            <div style="display: flex; gap: 2rem; align-items: center; justify-content: center; margin-bottom: 1rem;">
                <!-- Matrix Input -->
                <div class="matrix-input">
                    <div class="matrix-grid" style="grid-template-columns: 1fr 1fr;">
                        <input type="number" class="matrix-cell" id="det-m00" value="1" step="0.5">
                        <input type="number" class="matrix-cell" id="det-m01" value="0" step="0.5">
                        <input type="number" class="matrix-cell" id="det-m10" value="0" step="0.5">
                        <input type="number" class="matrix-cell" id="det-m11" value="1" step="0.5">
                    </div>
                </div>

                <!-- Calculation Display -->
                <div style="font-family: var(--font-mono); font-size: 1.1rem;">
                    <div style="margin-bottom: 0.5rem; color: var(--text-secondary);">计算公式 (ad - bc)：</div>
                    <div style="color: var(--accent-cyan);">
                        <span id="calc-ad">1</span> - <span id="calc-bc">0</span> = <strong id="val-det"
                            style="font-size: 1.4rem; color: var(--text-primary);">1.00</strong>
                    </div>
                </div>
            </div>

            <p style="text-align: center; color: #a0a0b0; font-size: 0.9rem;">
                <strong style="color: #10b981">绿色区域</strong>是变换后的单位正方形。
                <br>尝试将 $\begin{bmatrix} 1 & 0 \\ 0 & 1 \end{bmatrix}$ 改为 $\begin{bmatrix} 2 & 0 \\ 0 & 2
                \end{bmatrix}$，面积会变成几倍？
                <br>尝试输入 $\begin{bmatrix} 0 & 1 \\ 1 & 0 \end{bmatrix}$，看看面积颜色为何变红？
            </p>
        </div>
    </div>
</div>

<div class="section fade-in">
    <h2 class="section-title">4.2 奇异性与可逆性 <small
            style="font-weight: normal; color: var(--text-muted); font-size: 0.8em;">Singularity</small></h2>

    <div class="content-block">
        <p>
            行列式为零是一个巨大的红旗。它意味着矩阵是<strong>奇异的 (Singular)</strong>。
            几何上，这意味着变换将空间"压扁"到了更低的维度（例如，将二维平面压成一条一维直线）。
            在这种情况下，多个输入可能映射到同一个输出，因此无法找到唯一的逆变换（不可逆）。
        </p>
    </div>
</div>

<div class="section fade-in">
    <h2 class="section-title">4.3 常用词汇表 <small
            style="font-weight: normal; color: var(--text-muted); font-size: 0.8em;">Vocabulary</small></h2>

    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
        <div class="definition-card" style="margin:0">
            <strong style="color: var(--accent-blue)">中文术语</strong>
            <ul style="list-style: none; padding: 0; margin-top: 0.5rem; color: var(--text-secondary);">
                <li>行列式</li>
                <li>奇异矩阵</li>
                <li>可逆性</li>
                <li>方向/手性</li>
                <li>平行四边形</li>
            </ul>
        </div>
        <div class="definition-card" style="margin:0">
            <strong style="color: var(--accent-purple)">English Terms</strong>
            <ul style="list-style: none; padding: 0; margin-top: 0.5rem; color: var(--text-secondary);">
                <li>Determinant</li>
                <li>Singular Matrix</li>
                <li>Invertibility</li>
                <li>Orientation</li>
                <li>Parallelogram</li>
            </ul>
        </div>
    </div>
</div>