<div class="chapter-header fade-in">
    <span class="chapter-badge">第 6 章</span>
    <h1 class="chapter-title">矩阵乘法——变换的组合 <br><small style="font-size: 0.6em; color: var(--text-muted);">Matrix
            Multiplication: Composing Transformations</small></h1>

    <div class="problem-hook"
        style="background: linear-gradient(135deg, rgba(74, 158, 255, 0.15), rgba(139, 92, 246, 0.15)); padding: 2rem; border-radius: 16px; margin-top: 1.5rem;">
        <div style="font-size: 2rem; margin-bottom: 0.5rem;">🤖</div>
        <p style="font-size: 1.2rem; margin: 0; font-weight: bold;">
            "机器人手臂先转肩膀、再转肘部，最终位置怎么算？"
        </p>
        <p style="margin: 1rem 0 0 0; color: var(--text-muted);">
            答案是把两个变换矩阵<strong>相乘</strong>，得到一个"组合变换"矩阵。
        </p>
    </div>

    <div class="vocab-summary" style="margin-top: 2rem;">
        <div class="vocab-title">本章核心词汇</div>
        <div class="vocab-list">
            <div class="vocab-item"><span class="vocab-zh">矩阵乘法</span><span class="vocab-en">Matrix
                    Multiplication</span></div>
            <div class="vocab-item"><span class="vocab-zh">复合变换</span><span class="vocab-en">Composite
                    Transformation</span></div>
            <div class="vocab-item"><span class="vocab-zh">不可交换</span><span class="vocab-en">Non-Commutative</span>
            </div>
        </div>
    </div>
</div>

<!-- ==================== SECTION 1 ==================== -->
<div class="section fade-in">
    <h2 class="section-title">🔗 6.1 组合两个变换</h2>

    <div class="content-block">
        <p>假设要对向量 $\vec{v}$ 先做变换 $A$，再做变换 $B$：</p>
        <div class="math-block">
            $B(A(\vec{v})) = B \cdot (A \cdot \vec{v}) = (BA) \cdot \vec{v}$
        </div>

        <div class="aha-box" style="margin-top: 2rem;">
            <div class="aha-title">💡 关键洞察</div>
            <p>
                两个变换的组合 = 两个矩阵的乘积<br>
                <strong>注意顺序</strong>：先做的变换在右边！$BA$ 表示先 $A$ 后 $B$
            </p>
        </div>
    </div>
</div>

<!-- ==================== SECTION 2 ==================== -->
<div class="section fade-in">
    <h2 class="section-title">✖️ 6.2 矩阵乘法的计算</h2>

    <div class="content-block">
        <div class="definition-card">
            <div class="definition-title">矩阵乘法计算规则</div>
            <p>$AB$ 的第 $i$ 行第 $j$ 列元素 = $A$ 的第 $i$ 行 · $B$ 的第 $j$ 列</p>
            <div class="math-block">
                $\begin{bmatrix}a & b\\c & d\end{bmatrix}\begin{bmatrix}e & f\\g & h\end{bmatrix} = \begin{bmatrix}ae+bg
                & af+bh\\ce+dg & cf+dh\end{bmatrix}$
            </div>
        </div>

        <div class="example-ladder" style="margin-top: 2rem;">
            <div class="example-step">
                <div class="step-number">例</div>
                <div class="step-content">
                    <div class="step-label">先旋转 90°，再放大 2 倍</div>
                    <div class="math-block">
                        $\begin{bmatrix}2 & 0\\0 & 2\end{bmatrix}\begin{bmatrix}0 & -1\\1 & 0\end{bmatrix} =
                        \begin{bmatrix}0 & -2\\2 & 0\end{bmatrix}$
                    </div>
                    <p>结果：先旋转后放大的组合变换矩阵</p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- ==================== SECTION 3 ==================== -->
<div class="section fade-in">
    <h2 class="section-title">⚠️ 6.3 顺序很重要！</h2>

    <div class="content-block">
        <div class="definition-card" style="border-left-color: var(--accent-orange);">
            <div class="definition-title" style="color: var(--accent-orange);">矩阵乘法不可交换</div>
            <p>一般情况下：$AB \neq BA$</p>
            <p style="margin-top: 0.5rem;">先旋转再缩放 ≠ 先缩放再旋转（虽然这个特例恰好相等）</p>
            <p>先旋转再剪切 ≠ 先剪切再旋转！</p>
        </div>

        <div class="deep-dive" style="margin-top: 2rem;">
            <div class="deep-title">🎮 类比：穿衣服的顺序</div>
            <p>
                先穿袜子再穿鞋 ≠ 先穿鞋再穿袜子<br>
                矩阵乘法也是如此——顺序改变结果！
            </p>
        </div>
    </div>
</div>

<!-- ==================== 实战应用 ==================== -->
<div class="section fade-in">
    <h2 class="section-title">🎯 实战应用</h2>

    <div class="content-block">
        <!-- 问题1：动画变换链 - 详细分析 -->
        <div class="deep-dive" style="border-left: 4px solid var(--accent-blue); margin-bottom: 2rem;">
            <div class="deep-title">🎮 问题：游戏动画变换链</div>
            <div style="background: rgba(74, 158, 255, 0.05); padding: 1rem; border-radius: 8px; margin: 1rem 0;">
                <p><strong>场景</strong>：游戏角色要做一个特效动画：</p>
                <ol>
                    <li>先缩小到 0.5 倍</li>
                    <li>再旋转 90°</li>
                </ol>
                <p><strong>问题</strong>：点 $(4, 2)$ 经过这两个变换后在哪里？</p>
            </div>

            <div class="example-ladder">
                <div class="example-step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <div class="step-label">写出各个变换矩阵</div>
                        <p>缩放：$S = \begin{bmatrix}0.5 & 0\\0 & 0.5\end{bmatrix}$</p>
                        <p>旋转90°：$R = \begin{bmatrix}0 & -1\\1 & 0\end{bmatrix}$</p>
                    </div>
                </div>
                <div class="example-step">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <div class="step-label">计算组合矩阵（后做的在左边）</div>
                        <div class="math-block">
                            $M = R \cdot S = \begin{bmatrix}0 & -1\\1 & 0\end{bmatrix}\begin{bmatrix}0.5 & 0\\0 &
                            0.5\end{bmatrix} = \begin{bmatrix}0 & -0.5\\0.5 & 0\end{bmatrix}$
                        </div>
                    </div>
                </div>
                <div class="example-step">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <div class="step-label">应用到点 $(4, 2)$</div>
                        <div class="math-block">
                            $M \cdot \begin{bmatrix}4\\2\end{bmatrix} = \begin{bmatrix}0 & -0.5\\0.5 &
                            0\end{bmatrix}\begin{bmatrix}4\\2\end{bmatrix} = \begin{bmatrix}-1\\2\end{bmatrix}$
                        </div>
                    </div>
                </div>
                <div class="example-step">
                    <div class="step-number">✓</div>
                    <div class="step-content" style="background: rgba(16, 185, 129, 0.1);">
                        <div class="step-label" style="color: var(--accent-green);">答案与验证</div>
                        <p>最终位置：$(-1, 2)$</p>
                        <p>验证：原距离 $\sqrt{20} \approx 4.47$，新距离 $\sqrt{5} \approx 2.24 = 4.47 \times 0.5$ ✓</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- 问题2：机器人手臂 - 详细分析 -->
        <div class="deep-dive" style="border-left: 4px solid var(--accent-orange);">
            <div class="deep-title">🤖 问题：二关节机器人手臂</div>
            <div style="background: rgba(249, 115, 22, 0.05); padding: 1rem; border-radius: 8px; margin: 1rem 0;">
                <p><strong>场景</strong>：机器人手臂从原点开始，第一节长度 3，旋转 30°；第二节长度 2，再旋转 45°。</p>
                <p><strong>问题</strong>：末端执行器的位置在哪里？</p>
            </div>

            <div class="example-ladder">
                <div class="example-step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <div class="step-label">第一节末端（从原点旋转30°走3单位）</div>
                        <p>$P_1 = (3\cos 30°, 3\sin 30°) = (2.6, 1.5)$</p>
                    </div>
                </div>
                <div class="example-step">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <div class="step-label">第二节方向（累计旋转30°+45°=75°）</div>
                        <p>$P_2 = P_1 + (2\cos 75°, 2\sin 75°)$</p>
                        <p>$= (2.6 + 0.52, 1.5 + 1.93) = (3.12, 3.43)$</p>
                    </div>
                </div>
                <div class="example-step">
                    <div class="step-number">✓</div>
                    <div class="step-content" style="background: rgba(16, 185, 129, 0.1);">
                        <div class="step-label" style="color: var(--accent-green);">答案</div>
                        <p>末端位置：$(3.12, 3.43)$</p>
                        <p>矩阵方法：$T_{总} = R_{30°} \cdot T_{3单位} \cdot R_{45°} \cdot T_{2单位}$</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- ==================== 总结 ==================== -->
<div class="section fade-in">
    <h2 class="section-title">🎯 本章收获</h2>

    <div class="content-block">
        <div class="theorem-card">
            <div class="theorem-title">核心要点</div>
            <ol style="margin: 0; padding-left: 1.5rem; line-height: 2.2;">
                <li><span class="term" data-en="Matrix Multiplication">矩阵乘法</span> = 复合变换</li>
                <li>$BA$ 表示先做 $A$ 再做 $B$（从右往左读）</li>
                <li><strong>顺序很重要</strong>：$AB \neq BA$</li>
                <li>计算技巧：行 × 列 求和</li>
            </ol>
        </div>

        <div class="connection-box" style="margin-top: 2rem;">
            <div class="connection-title">📍 下一章预告</div>
            <p>
                变换会改变面积吗？改变多少？<br>
                这就是<strong>行列式</strong>的意义——面积缩放因子！
            </p>
        </div>
    </div>
</div>